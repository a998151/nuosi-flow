<?xml version="1.0" encoding="UTF-8"?>
<logic-flow id="simple_logic_flow_example"
            name="简单逻辑流程范例"
            desc="简单逻辑流程范例">
    <!-- 全局域 -->
    <define>
        <!-- 引入model定义 -->
        <import model="goods_info"/>
        <var id="goods_type" type="int" name="货物类型">
            <limit max="10"/>
        </var>
        <var id="user_id" type="int" name="用户标识"/>
        <var id="user_name" type="string" name="用户名称"/>
    </define>

    <start id="start" name="开始节点" next="goodsCheck">
        <!-- 逻辑入口参数校验 -->
        <var model="goods_info" attr="goods_name" key="goods_name"/>
        <var model="goods_info" attr="goods_type" key="goods_type"/>
    </start>

    <action id="goodsCheck" name="货物校验" next="queryGoodsInfo">
        <input>
        </input>
        <rule>
        </rule>
        <output>
        </output>
    </action>

    <action id="queryGoodsInfo" name="查询货物信息" next="goodsInfoMapping">
        <!-- 全局域 -->
        <input>
            <var key="goods_name"/>
            <var key="goods_type"/>
            <var key="user_id" id="user_id"/>
        </input>
        <sql conn="dynamic-form-test">
        <![CDATA[
        SELECT id, goods_name, price, goods_type
            FROM cb_goods
            WHERE goods_name = #{goods_name} and goods_type = #{goods_type};
        ]]>
        </sql>
        <output>
            <var model="goods_info" attr="id" key="goods_id"/>
            <var model="goods_info" attr="goods_name"/>
            <var model="goods_info" attr="price" key="goods_price"/>
            <var model="goods_info" attr="goods_type"/>
        </output>
    </action>

    <end id="end" name="结束节点">
        <var id="goods_info" type="bdata" name="货物信息"/>
    </end>
</logic-flow>